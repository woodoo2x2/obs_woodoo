# Запуск браузера с расширениями

Чтобы запустить браузер с уже установленным расширением, сначала нам нужно подготовить это расширение. В Chrome есть [магазин расширений](https://chrome.google.com/webstore/category/extensions?hl=ru) и я надеюсь, что все об этом знают и хотя бы раз в жизни им пользовались.

UPD: Расширение "**coordinates**" теперь недоступно в магазине расширений, поэтому мы будем использовать "**Mouse Coordinates**", которое работает по аналогичному принципу.

Давайте найдём расширение, которое поможет нам определить координаты курсора. Кстати, оно пригодится нам для решения одной из задачек ;) Это расширение называется "Mouse Coordinates", и скачать его можно по [ссылке](https://chrome.google.com/webstore/detail/mouse-coordinates/gkkmpbaijflcgbbdfjgihbgmpkhgpgof?hl=ru). Установите его привычным образом.

Чтобы подготовить расширение для работы, нам необходимо его упаковать. Для этого запустим Chrome и перейдем в раздел расширений **chrome://extensions** ("Меню" → "Настройки" → "Расширения") → далее отметим чекбокс (флажок) "Режим разработчика" →  "Упаковать расширение" (скриншот) укажем путь, куда необходимо сохранить расширение. → "ОК".

![](https://ucarecdn.com/a3e671af-c1f3-4e66-bee8-2a236b307393/)

Нажмите на "Упаковать расширение" и в появившемся окне, укажите путь к нужному вам расширению.

![](https://ucarecdn.com/1f71762b-0527-43a2-afef-b2f011e21382/)

### Для Windows:

- Путь до папки с расширениями на Windows обычно выглядит так:
    
    ```
    ​​​​​​​C:\Users\[Ваш_пользователь]\AppData\Local\Google\Chrome\User Data\Default\Extensions
    ```
    
    ​​

### Для macOS:

- Путь для macOS чаще всего такой: `~/Library/Application Support/Google/Chrome/Default/Extensions`

### Для Linux:

- Путь в Linux: `~/.config/google-chrome/Default/Extensions`

Или в адресной строке браузера напишите **chrome://version/** и найдите там путь к папке **Default** в которой хранятся все расширения.   
![](https://ucarecdn.com/8a439a33-9211-4dff-be7a-1c930f688540/)

Обратите внимание что создаётся 2 файла:

- **0.2_0****.crx**  - упакованное расширение;
- **0.2_0.pem** - файл ключей, который необходимо будет удалить если, потребуется повторная упаковка расширения (имя будет соответствовать названия расширения).

![](https://ucarecdn.com/1812645b-b2bd-4d92-9543-1f4f588c05bf/)

Путь к расширению может выглядеть подобным образом, где **Default** это имя вашего профиля =>

C:\Users\user\AppData\Local\Google\Chrome\User Data\Default\**Extensions\ghbmnnjooekpmoecnnnilnnbdlolhkhi\**

Все расширения имеют странные названия, примерно такие как на изображении ниже, чтобы найти то, которое только что упаковали, найдите его по идентификатору  
​​​​​​​

![](https://ucarecdn.com/36897aa3-6779-48b4-9934-29675e23f8ac/)

![](https://ucarecdn.com/a011df3a-8baf-44f5-8fcd-1bde51008b36/)

После упаковки расширения в папке появится файл "**0.2_0****.crx"**, это и есть наше упакованное расширение, теперь оно готово к использованию. Осталось "скормить" его в **Selenium**.  
Упакованное расширения появится в той же папке что и саморасширение.

![](https://ucarecdn.com/906b8140-1436-4351-a491-4ee242e15015/)

_ps.Имя папок и файлов  у вас может отличатся._

### _Скармливаем_ "**0.2_0.crx" в Selenium**

Для удобства переименуем файл **0.2_0.crx** в **coordinates.crx**

В методе `.add_extension('coordinates.crx')` мы указываем путь к нашему упакованному расширению. Если расширение находится в папке с проектом, достаточно указать только его имя.

Также необходимо передать опции в **webdriver**. Это делается так: `webdriver.Chrome(options=)`.

```python
import time
from selenium import webdriver

options_chrome = webdriver.ChromeOptions()
options_chrome.add_extension('coordinates.crx')

with webdriver.Chrome(options=options_chrome) as browser:
    url = 'https://stepik.org/course/104774'
    browser.get(url)
    time.sleep(15)
```

Если все сделано правильно, при запуске браузера с **Selenium,** в нём будет установлено наше расширение.

Перед запуском кода, установите достаточную задержку, чтобы запустить его у себя и убедиться в этом самостоятельно.

![](https://ucarecdn.com/7bbeb695-e532-4236-bdd7-4d5c9f29e182/)

### Когда полезно запускать **Selenium** c расширениями? 

1. **Блокировка рекламы**: Если тестирование веб-сайта затруднено из-за рекламы, можно использовать расширения типа AdBlock для их блокировки.
    
2. **Повышение безопасности**: Расширения вроде HTTPS Everywhere могут обеспечить шифрование трафика, что актуально для тестирования веб-сайтов с фокусом на безопасности.
    
3. **Эмуляция мобильных устройств**: Некоторые расширения позволяют эмулировать мобильный браузер, что может быть полезно для тестирования адаптивных веб-сайтов.
    
4. **Манипуляции с куками**: Расширения типа EditThisCookie дают возможность быстро изменять или удалять куки прямо в браузере.
    
5. **Отладка и анализ**: Расширения вроде Firebug или Developer Tools могут быть полезными для быстрой отладки и анализа веб-страниц.
    
6. **Скриншоты и запись экрана**: Для документации ошибок или для создания инструкций можно использовать расширения для создания скриншотов или видеозаписи экрана.
    
7. **Специфичные нужды**: Некоторые тестовые сценарии могут требовать очень специфических действий, которые можно автоматизировать с помощью специализированных расширений.
    
8. **Смена User-Agent**: Некоторые сайты разрешают доступ только определённым браузерам или устройствам. Здесь на помощь придут расширения для смены User-Agent.
    

### Некоторые популярные расширения.

1. **AdBlock / uBlock Origin**: для блокировки рекламы.
    
2. **EditThisCookie**: для работы с куками.
    
3. **User-Agent Switcher**: для смены User-Agent.
    
4. **Firebug / Chrome Developer Tools**: для отладки и анализа.
    
5. **Screenshot**: для скриншотов и записи экрана.
    
6. **LastPass / 1Password**: для автоматического заполнения форм, если это нужно в тестах.
    
7. **Proxy SwitchyOmega**: для работы с прокси-серверами.
    
8. **Wappalyzer**: для определения технологий, используемых на веб-сайте.
    
9. **Tampermonkey:** Для запуска пользовательских скриптов, что может быть полезно для автоматизации сложных действий на веб-странице.