[Сессия](https://requests.readthedocs.io/en/latest/user/advanced/) в контексте HTTP - это механизм, который позволяет сохранять определенные параметры и данные между последовательными запросами. Сессии особенно полезны при веб-парсинге, поскольку они могут улучшить производительность и эффективность ваших парсинг-задач, минимизируя накладные расходы на установку новых соединений и позволяя переиспользовать параметры запросов.

### Применение Request Sessions:

Сессии `requests` особенно полезны в следующих сценариях:

1. **Постоянство Cookies**: Сессии автоматически сохраняют cookies между запросами, что полезно при взаимодействии с веб-сайтами, требующими аутентификации.
2. **Пулы соединений**: Сессии управляют пулами соединений, повышая эффективность при множественных запросах к одному и тому же хосту.
3. **Конфигурация**: Сессии позволяют централизованно настроить параметры запросов, такие как заголовки, параметры прокси и таймауты, что упрощает их использование.

### Когда лучше не использовать Request Sessions:

1. **Одноразовые запросы**: Если вам нужно сделать всего один запрос, использование сессии может быть избыточным, и проще использовать функции на уровне модуля, такие как `requests.get()` или `requests.post()`.
2. **Отсутствие необходимости в постоянстве**: Если нет необходимости в постоянстве cookies или других параметров между запросами, сессия может быть ненужной.

Пример использования Сессии:

```python
import requests

# Создание объекта сессии
session = requests.Session()

# Установка заголовков для сессии
session.headers.update({'User-Agent': 'my_parser'})

# Отправка запроса через объект сессии
response = session.get('https://example.com')

# Доступ к тексту ответа
print(session.headers['User-Agent'])
```

В этом примере мы создаем объект сессии, устанавливаем заголовок `User-Agent` для сессии, а затем отправляем HTTP-запрос методом `GET` к `https://example.com`. Все последующие запросы через этот объект сессии будут иметь установленный заголовок `User-Agent`.

### Переиспользование соединений.

Оба кода делают одно и то же - шлют запросы на сайт и засекают время, которое на это уходит. Но делают они это по-разному.

```python
# Код с сессией

import requests
import time

# Создание объекта сессии
session = requests.Session()

# Измерение времени выполнения запросов с переиспользованием соединения
start_time = time.time()
for _ in range(10):
    response = session.get('https://example.com')
end_time = time.time()

print(f'Время выполнения с переиспользованием соединения: {end_time - start_time}')
```

Вывод:

```
Время выполнения с переиспользованием соединения: 2.0185153484344482
```

В этом коде создается сессия, которая помогает переиспользовать соединение и быстрее общаться с сайтом. Код отправил 10 запросов на `https://example.com`, засек время и рассказал нам о результате.  
 

```python
# Код без сессии

import requests
import time

# Измерение времени выполнения запросов
start_time = time.time()
for _ in range(10):
    response = requests.get('https://example.com')
end_time = time.time()

print(f'Время выполнения: {end_time - start_time}')
```

Вывод:

```
Время выполнения: 6.182783126831055
```

Этот код тоже отправляет 10 запросов на сайт, но без сессии. Из-за этого каждый запрос начинает общение с сайтом с нуля, что занимает больше времени. Код также засекает время и выводит результат.

### Что отличает один код от другого?

1. **Переиспользование соединений:** Первый код с сессией переиспользует одно соединение для всех запросов, а второй устанавливает новое соединение для каждого запроса.
    
2. **Скорость:** Благодаря сессии первый код работает быстрее, что видно по времени выполнения.
    

### Плюшки от использования сессий:

1. **Быстродействие:** Сессии ускоряют запросы, особенно когда их много. Это экономит время, и код работает быстрее.
    
2. **Экономия:** Переиспользование соединения экономит ресурсы, на твоей машине, и на сервере.
    
3. **Меньше задержек:** Каждый новый запрос без сессии влечет за собой задержки из-за установки соединения с нуля.
    

Если планируешь делать много запросов на один сайт или кучу сайтов, сессии - твой выбор. Это особенно круто при веб-парсинге, когда запросов много и каждая миллисекунда на счету.




#ПарсингPython 