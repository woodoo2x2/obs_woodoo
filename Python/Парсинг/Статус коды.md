При первых попытках парсинга веб-страниц, я, честно говоря, не особо задумывался о том, что такое [HTTP статус-коды](https://developer.mozilla.org/ru/docs/Web/HTTP/Status). Моя цель была простой: достать нужную информацию с сайта и сохранить её. Но вскоре я столкнулся с различными проблемами — иногда мой код просто не работал, иногда данные приходили неполными, а иногда мне даже блокировали доступ к сайту.

Так вот, именно в эти моменты я понял, что знание HTTP статус-кодов — это не просто "хорошо уметь", это "нужно уметь". Эти небольшие трехзначные числа могут рассказать многое о том, что происходит "под капотом" при взаимодействии с веб-сайтами. Они помогут понять, успешно ли выполнен запрос, нужно ли что-то изменить в настройках или же просто подождать.

Знание статус-кодов дает понимание о том, как строить устойчивые и эффективные скрипты для парсинга. Это особенно полезно, когда сервер ограничивает количество запросов, или когда необходимо обрабатывать перенаправления и ошибки. В этой статье мы разберем, какие бывают HTTP статус-коды, что они означают и как с ними работать в Python с использованием библиотеки `requests`.

- Информационные 100 - 199
- Успешные 200 - 299
- Перенаправления 300 - 399
- Клиентские ошибки 400 - 499
- Серверные ошибки 500 - 599

|   |   |   |
|---|---|---|
|**200**|OK|"Успешно". Запрос успешно обработан.|

В 95% случаев нас интересует код с номером 200, т.к. он гарантирует, что ответ с сервера пришел полностью и без каких-либо ограничений.

  
Вот основные HTTP статус-коды, которые часто встречаются при работе с парсингом веб-сайтов:

|   |   |
|---|---|
|**301**|Ресурс переехал на новый URL. Парсеру следует перейти по новому адресу.|

|   |   |
|---|---|
|**302**|Ресурс временно переехал. Парсер может перейти по новому адресу, но стоит помнить, что это перенаправление временное.|

|   |   |
|---|---|
|**400**|Неверный запрос. Это может быть связано с неверно сформированным запросом или заголовками.|

|   |   |
|---|---|
|**403**|Доступ к ресурсу запрещен. Сервер понял запрос, но он отказывается его выполнять. Обычно это связано с ограничениями доступа.|

|   |   |
|---|---|
|**404**|Ресурс не найден. Этот код часто встречается, если вы пытаетесь парсить несуществующую страницу.|

|   |   |
|---|---|
|**429**|Слишком много запросов. Это указывает на то, что вы превысили лимит запросов и должны подождать.|

|   |   |
|---|---|
|**500**|Внутренняя ошибка сервера. Это может быть связано с временными проблемами на сервере.|

|   |   |
|---|---|
|**502**|Неверный шлюз. Обычно связано с проблемами на стороне сервера, которые парсер не может контролировать.|

|   |   |
|---|---|
|**503**|Сервис недоступен. Сервер временно не может обработать запросы, возможно, из-за перегрузки или технических работ.|

|   |   |
|---|---|
|**200**|"Успешно". Запрос успешно обработан.|

Каждый из этих статус-кодов требует особого подхода при написании парсера. Некоторые из них указывают на необходимость изменить логику скрипта, добавить задержки или даже прекратить выполнение программы. Знание и правильная интерпретация этих кодов помогут создать более надежный и эффективный инструмент для парсинга данных.

Используя атрибут `status_code` , мы можем увидеть, какой код мы получили в ответ.

```
import requests

url = 'http://httpbin.org/'
response = requests.get(url)
print(response.status_code)

>>> 200
```

Попробуйте заменить URL на несуществующий, чтобы увидеть ошибку ответа 404.

Также мы можем совершить проверку статус кода. И отталкиваясь от этого строить свой код.

```
import requests

url = 'http://httpbin.org/'
response = requests.get(url)
if response.status_code == 200:
    print("status_code OK")
else:
    print("status_code NOT OK")

>>> status_code OK
```

Это может пригодиться, когда сервер позволяет совершать определенное количество запросов за определенный промежуток времени, и, чтобы наш скрипт не падал,  мы можем добавить ожидание. 

Если статус-код не равен 200, спим 60 секунд, иначе продолжаем выполнение скрипта.

```
import requests
import time

url = 'http://httpbin.org/'
response = requests.get(url)
if response.status_code != 200:
    time.sleep(60)
else:
    print("status_code OK... Continue execute code...")
```

#ПарсингPython 