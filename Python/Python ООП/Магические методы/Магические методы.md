
Магические методы – это общий термин, относящийся к специальным методам в классах Python. Для них нет единого определения, поскольку их применение разнообразно. Магические методы, как правило, добавляют в класс специальный функционал. Они всегда обрамлены двумя нижними подчеркиваниями, например, [[Магический метод __init__()|__init__()]].)

Магические методы не предназначены для прямого вызова, однако их вызов происходит автоматически при определенных действиях. Например, мы явно не вызываем метод `__init__()` при создании нового экземпляра класса, но вместо этого данный метод вызывается внутренне. Все, что нам нужно сделать, это реализовать метод внутри класса должным образом.

Поскольку магические методы характеризуются двойным подчеркиванием, их часто называют dunders, что означает Double Underscore.

Добавление нижних подчеркиваний к произвольному методу не сделает его магическим. Магические методы имеют для интерпретатора особое значение. Имена магических методов и их смысл определены создателями языка: создавать новые нельзя, можно только реализовывать существующие.


Магические методы:
1. [[Магический метод __init__()]]
2. [[Магический метод __new__()]]
3. [[Метод __del__()]]
4. [[Магические методы __str__() и __repr__()]]
5. [[Магические методы __eq__() и __ne__()]]
6. [[Магический метод __hash__()]] и [[Константа NotImplemented]]
7. [[Магические методы __lt__() и __gt__()]]
8. [[Магические методы __le__() и __ge__()]] и [[Декоратор @total_ordering]]
9. [[Унарные операторы для объектов]] и [[Магический метод __invert__()]] [[Магический метод __neg__()]] [[Магический метод __pos__()]]
10. [[Функции abs(), round(), trunc() и т.д. в ООП]]                                                  [[Магический метод __trunk__]];    [[Магический метод __round__]];[[Магический метод __abs__]];  [[Магический метод __ceil__]];  [[Магический метод __floor__]];
11. [[Магический метод __call__()]]
12. [[Магический метод __bool__()]]
13. [[Магические методы __int__(), __float__() и __complex__()]];[[Магический метод __index__()]]
14. [[Магический метод __getattr__()]] [[Магический метод __getattribute__()]] [[Магический метод __setattr__()]][[Магический метод __delattr__()]]
15. [[Магический метод __iter__()]] и [[Магический метод  __next__()]]
16. [[Магический метод __contains__()]] [[Магический метод __reversed__()]] [[Магический метод __len__()]]
17. [[Магический метод __enter__()]]  и [[Магический метод __exit__()]]
18. [[Магический метод __set_name__()]]
		
Вызов функций [[Функция getattr()]], [[Функция setattr()]] и [[Функция delattr()]], аналогично точечной нотации, приводит к вызовам соответствующих магических методов `__getattribute__(), __getattr__(), __setattr__()` и `__delattr__()`.

Приведенный ниже код:

```python
class Cat:
    def __getattribute__(self, attr):
        print(f'Возвращаю значение атрибута {attr}')
        return object.__getattribute__(self, attr)
    
    def __getattr__(self, attr):
        print(f'Возвращаю значение по умолчанию')
        return None
    
    def __setattr__(self, attr, value):
        print(f'Устанавливаю атрибуту {attr} значение {value}')
        self.__dict__[attr] = value
    
    def __delattr__(self, attr):
        print(f'Удаляю атрибут {attr}')
        del self.__dict__[attr]


cat = Cat()

setattr(cat, 'name', 'Кемаль')
print()
getattr(cat, 'name')
print()
getattr(cat, 'breed')
print()
delattr(cat, 'name')
```

выводит:

```no-highlight
Устанавливаю атрибуту name значение Кемаль
Возвращаю значение атрибута __dict__

Возвращаю значение атрибута name

Возвращаю значение атрибута breed
Возвращаю значение по умолчанию

Удаляю атрибут name
Возвращаю значение атрибута __dict__
```


В Python существуют методы, которые редко вызываются напрямую, при этом они постоянно вызываются встроенными функциями и операторами, даже если мы об этом не знаем. Такие методы называются магическими и обрамляются двойным нижним подчеркиванием с двух сторон.

Использование магических методов позволяет сделать работу с создаваемыми пользователем объектами удобной за счет схожести с встроенными объектами языка.

  Магические методы еще называют dunders от double underscore (двойное нижнее подчеркивание).

Например, у объектов типа [[list (Списки)]] есть магические методы [[Магический метод __len__()]] и [[Магические методы __str__() и __repr__()]]. Первый магический метод вызывается автоматически встроенной функцией `len()`, которая возвращает длину списка, второй метод вызывается встроенной функцией `str()`, которая возвращает строковое представление списка.

Приведенный ниже код:

```python
words = ['hello', 'beegeek', 'python']

print(len(words))         # за кулисами вызывается магический метод __len__()
print(str(words))         # за кулисами вызывается магический метод __str__()
```

выводит:

```no-highlight
3
['hello', 'beegeek', 'python']
```

Нам ничего не мешает вызвать указанные магические методы напрямую.

Приведенный ниже код:

```python
words = ['hello', 'beegeek', 'python']

print(words.__len__())
print(words.__str__())
```

также выводит:

```no-highlight
3
['hello', 'beegeek', 'python']
```

На практике нам редко приходится явно вызывать магические методы. Обычно за нас это делают встроенные функции языка Python.

Посмотреть список всех методов и атрибутов Python объекта можно с помощью встроенной [[Функция dir()]].

Приведенный ниже код:

```python
words = ['hello', 'beegeek', 'python']

print(dir(words))
```

выводит:

```no-highlight
['__add__', '__class__', '__class_getitem__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__iadd__', '__imul__', '__init__', '__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__', '__rmul__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'append', 'clear', 'copy', 'count', 'extend', 'index', 'insert', 'pop', 'remove', 'reverse', 'sort']
```

Обратите внимание на то, что публичные методы, то есть методы которые вызываются явно ([[Метод append()(list)]], [[Метод count()(list)]], [[Метод extend()(list)]], [[Метод index()(list)]] и т.д.), не имеют нижних подчеркиваний.
