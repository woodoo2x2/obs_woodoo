

**Коллекция** — объект, хранящий набор значений одного или различных типов, позволяющий обращаться к этим значениям, а также применять специальные функции и методы, зависящие от типа коллекции.

Также среди коллекций можно выделить те, элементы которых пронумерованы индексами и расположены в строгом порядке. Такие коллекции называются **последовательностями**. Например, списки, строки и кортежи являются последовательностями, а множества и словари нет.

Коллекции не являются итераторами сами по себе, но позволяют создать итератор на своей основе.

Для того чтобы создать итератор на основе некоторой коллекции, достаточно вызвать встроенную [[Функция iter()]], передав нужную коллекцию в качестве ее аргумента.

Например, список не является итератором, но на его основе можно создать сколько угодно итераторов, каждый из которых будет перебирать элементы списка от первого до последнего.

  Большинство функций, которые работают с итераторами, работают также и с коллекциями.

Приведенный ниже код:

```python
numbers = [1, 2, 3]

iterator = iter(numbers)          # создаем итератор на основании списка

print(next(iterator))             # запрашиваем и печатаем первый элемент итератора
print(next(iterator))             # запрашиваем и печатаем второй элемент итератора
print(next(iterator))             # запрашиваем и печатаем третий элемент итератора
```

выводит:

```no-highlight
1
2
3
```

Получить итератор можно из любого итерируемого объекта, для этого нужно передать итерируемый объект во встроенную функцию `iter()`.

![](https://ucarecdn.com/2e2c1aea-ef6c-4a42-8e73-aea25d40efd1/)

После того как мы получили итератор, мы можем передать его встроенной функции[[Функция next()]]. При каждом новом вызове, функция `next()` возвращает очередной элемент итератора. Если же в итераторе элементов больше не осталось, то функция `next()` возбуждает исключение `StopIteration`.

Приведенный ниже код:

```python
numbers = [1, 2, 3]

iterator = iter(numbers)          # создаем итератор на основе списка

print(next(iterator))             # запрашиваем и печатаем первый элемент итератора
print(next(iterator))             # запрашиваем и печатаем второй элемент итератора
print(next(iterator))             # запрашиваем и печатаем третий элемент итератора

print(next(iterator))             # возбуждается исключение StopIteration
```

приводит к возникновению исключения `StopIteration`.

Единственное, что мы можем сделать с итератором, — передать его функции `next()`. Как только итератор становится пустым и порождается исключение `StopIteration`, он становится совершенно бесполезным.
![](https://ucarecdn.com/c4eee96c-4366-453d-b225-08c0c94710a8/)
Основная разница между последовательностями и итераторами, заключается в том, что в последовательностях элементы пронумерованы индексами, начиная от нуля. Мы можем обратиться к конкретному элементу таких объектов по индексу. В итераторах мы можем лишь последовательно запрашивать следующий элемент.

Приведенный ниже код:

```python
numbers = [1, 2, 3, 4]            # список
letters = ('a', 'b', 'c')         # кортеж
language = 'python'               # строка

print(numbers[3])                 # обращение по индексу
print(letters[2])                 # обращение по индексу
print(language[5])                # обращение по индексу
```

выводит:

```no-highlight
4
c
n
```

Приведенный ниже код:

```python
letters = ('a', 'b', 'c')

iterator = iter(letters)           # создаем итератор на основе кортежа

print(iterator[1])                 # обращение по индексу
```

приводит к возникновению исключения:

```no-highlight
TypeError: 'tuple_iterator' object is not subscriptable
```

Не забывайте, что коллекции не являются итераторами. Поэтому встроенная функция `next()` не позволяет получить очередной элемент, например списка, строки и т.д.

Приведенный ниже код:

```python
nums = [1, 2, 3, 4]

print(next(nums))
```

приводит к возникновению исключения:

```no-highlight
TypeError: 'list' object is not an iterator
```

Но на основе коллекции можно создать итератор.

Приведенный ниже код:

```python
nums = [1, 2, 3, 4]
nums_iterator = iter(nums)       # создаем итератор

print(type(nums))
print(type(nums_iterator))
print(next(nums_iterator))
print(next(nums_iterator))
```

выводит:

```no-highlight
<class 'list'>
<class 'list_iterator'>
1
2
```
[[Итератор]] может **генерировать бесконечное число значений**, не занимая много дополнительной памяти. Например, итератор может генерировать все натуральные числа или все простые числа. Или генерировать значения, количество которых заранее неизвестно.

Встроенная [[Функция len()]] не работает с большей частью итерируемых объектов, потому что их длина может быть очень большой или даже бесконечной.

Приведенный ниже код:

```python
numbers = [1, 2, 3, 4, 5, 6]

evens = filter(lambda num: num % 2 == 0, numbers)
print(len(evens))
```

приводит к возникновению ошибки:

```no-highlight
TypeError: object of type 'filter' has no len()
```

В случае с итерируемыми объектами, которые являются итераторами, посчитать длину можно только если полностью пройти итератор от начала до конца, что может быть очень долго. Для итераторов, про которые заранее неизвестно, бесконечные они или нет, функция `len()` могла бы работать не просто долго, а вечно. Именно поэтому функция `len()` не применима к итераторам.

Для некоторых итерируемых объектов длину можно посчитать мгновенно, не перебирая элементы. К таким объектам можно отнести числовые последовательности `range`.

Приведенный ниже код:

```python
numbers1 = range(5)                  # 5 чисел в последовательности
numbers2 = range(100000)             # 100000 чисел в последовательности
numbers3 = range(10000000000000)     # 10000000000000 чисел в последовательности

print(len(numbers1))
print(len(numbers2))
print(len(numbers3))
```

выводит:

```no-highlight
5
100000
10000000000000
```

 Обратите внимание на то, что на основе одного списка (кортежа, строки, множества, словаря и т.д.) мы можем создавать множество несвязанных между собой итераторов. Каждый из них будет независимо от других перемещаться от начала до конца.

Приведенный ниже код:

```python
numbers = list(range(1, 10))

iterator1 = iter(numbers)
iterator2 = iter(numbers)
iterator3 = iter(numbers)

print(numbers)

print(next(iterator1))
print(next(iterator1))

print(next(iterator2))

print(next(iterator3))
print(next(iterator3))
print(next(iterator3))
print(next(iterator3))
print(next(iterator3))
```

выводит:

```no-highlight
[1, 2, 3, 4, 5, 6, 7, 8, 9]
1
2
1
1
2
3
4
5
```

![](https://ucarecdn.com/d6252583-8131-4916-8985-04a8ebf110c1/)