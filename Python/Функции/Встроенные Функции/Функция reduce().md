Функция reduce()

Реализованные нами функции `map()` и `filter()` работали с отдельными элементами списка независимо. Но встречаются циклы с агрегацией результата — формированием одного результирующего значения при комбинации элементов с использованием аргумента-аккумулятора.

Типичные примеры агрегации — сумма всех элементов списка или их произведение.

Приведенный ниже код:

```python
numbers = [1, 2, 3, 4, 5]

total = 0
product = 1

for num in numbers:
    total += num
    product *= num

print(total)
print(product)
```

вычисляет сумму и произведение элементов списка и выводит:

```no-highlight
15
120
```

С точки зрения математики сумма 1+2+3+4+5 может быть выражена как:

(((((0+1)+2)+3)+4)+5).(Нуль здесь – тот самый аккумулятор, точнее его начальное значение. Он не добавляет к сумме ничего, поэтому может служить отправной точкой. А еще нуль будет результатом, если входной список пуст.

Несложно понять, что этот цикл будет выглядеть одинаково практически во всех случаях. Меняться будет только начальное значение аккумулятора (0 для суммы, 1 для произведения и т.д.) и операция, которая комбинирует элемент и аккумулятор. Так почему бы не обобщить этот код? Так и сделаем:

```python
def reduce(operation, items, initial_value):
    acc = initial_value
    for item in items:
        acc = operation(acc, item)

    return acc
```

Приведенный ниже код, при условии, что функция `reduce()` определена как указано выше:

```python
def add(x, y):
    return x+y


def mult(x, y):
    return x*y


numbers = [1, 2, 3, 4, 5]

total = reduce(add, numbers, 0)
product = reduce(mult, numbers, 1)

print(total)
print(product)
```

выводит:

```no-highlight
15
120
```

Функция reduce()

Для использования функции `reduce()` необходимо подключить специальный модуль `functools`. Функция `reduce()` имеет сигнатуру `reduce(func, iterable, initializer=None)`. Если начальное значение не установлено, то в его качестве используется первое значение из последовательности `iterable`.

Приведенный ниже код:

```python
from functools import reduce


def func(a, b):
    return a + b


numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
total = reduce(func, numbers, 0)   # в качестве начального значения 0
print(total)
```

выводит:

```no-highlight
55
```

Обратите внимание на то, что мы могли вызвать функцию так:

```python
total = reduce(func, numbers)   # в качестве начального значения первый элемент списка numbers
```

)Функция `reduce()` во второй версии языка Python была встроенной, но в Python 3 ее решили перенести в модуль [[Модуль functools]]`. Функция `reduce()` как и функции `map()` и `filter()` может принимать любой итерируемый объект.
