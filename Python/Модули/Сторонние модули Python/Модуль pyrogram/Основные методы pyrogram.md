Важно отметить, что использование API Telegram для парсинга чатов и групп может нарушать политику конфиденциальности и условия использования Telegram. Убедитесь, что вы соблюдаете все правила и рекомендации Telegram при использовании API.

В этом разделе вы познакомитесь с основными методами Pyrogram для парсинга. Почти все эти методы вам понадобятся для успешного решения задач, но на некоторых методах мы ещё остановимся подробнее. Добавьте ссылку на этот степ в закладки, чтобы постоянно подсматривать за нужными методами.  
  
Почти все перечисленные ​​​​​​функции возвращает "генератор(`yield`)", он выдает сообщения по одному каждый раз, когда вы их запрашиваете, это экономит память и может быть эффективнее, если сообщений много.

```
<generator object async_to_sync.<locals>.async_to_sync_gen at 0x0000017A21A85940>
```

```python
# Предположим, что у вас уже есть 'app', который является вашим клиентом Pyrogram.

for message in app.get_chat_history(chat_id):
    print(message.text)   # Это выведет текст каждого сообщения в чате.
```
Основные методы:

- `app.**get_chat()**`
- `app.**get_chat_member_s_()**`
- `app.**get_chat_member()**`
- `app.**get_messages()**`
- `app.**search_messages()**`
- `app.**get_chat_history()**`
- `app.**get_chat_photos()**`



`app.**get_chat(chat_id)**`: Получает информацию о чате по его идентификатору или имени пользователя.
`chat_id`- Уникальный идентификатор (int) или имя пользователя (str) целевого чата.
```python
# 1. Получить информацию о чате

def main():
    with app:
        group_url = "parsinger_pyrogram"
        chat = app.get_chat(group_url)
        print("Chat Info:", chat)

main()
```


`app.get_chat_members(chat_id, query, limit, filter)`: Получает список участников чата или группы.

- `chat_id(int | str)`- Идентификатор или имя пользователя чата. Это может быть:Целое число для идентификатора чата. Строка с именем пользователя или ссылкой на чат (например, `"@username" `или `"https://t.me/joinchat/..."`).

- `query(str, по умолчанию "")` - Строка поиска для фильтрации участников чата. Если строка не пустая, будут возвращены только участники, чьи имена или имена пользователей соответствуют запросу. 

- `limit(int, по умолчанию 0)` - Максимальное количество участников для возврата. Если значение равно 0, будут возвращены все участники.

- `filter(enums.ChatMembersFilter.SEARCH)`: - Фильтр для применения при поиске участников. Это значение из перечисления ChatMembersFilter, которое может включать в себя различные типы участников, такие как администраторы, участники и так далее. По умолчанию используется `ChatMembersFilter.SEARCH`, что означает поиск участников на основе строки запроса.

```python
2. Получить информацию об участниках чата  
  
def main():  
    group_url = "parsinger_pyrogram"  
    with app:  
        members = app.get_chat_members(group_url, limit=10)  
        for member in members:  
            print(member.user.first_name, member.user.id)  
  
main()  
  
  
  
  
#Псевдокод для наглядного использование всех параметров  
from pyrogram import Client, enums  
  
app = Client("my_account")  
  
def main():  
    group_url = "parsinger_pyrogram"  # Имя пользователя или идентификатор чата  
    query = "John"           # Строка поиска для фильтрации участников по имени  
    limit = 10               # Максимальное количество участников для возврата  
    filter = enums.ChatMembersFilter.ADMINISTRATORS  # Фильтр для поиска администраторов чата  
  
    with app:  
        members = app.get_chat_members(group_url, query=query, limit=limit, filter=filter)  
        for member in members:  
            print(member.user.first_name, member.user.id)  
  
if __name__ == "__main__":  
    main()
```


`app.**get_chat_member**(**chat_id**, **user_id**)`: Получает информацию об определенном участнике чата или группы.

- `**chat_id**(int | str)` - Уникальный идентификатор (`int`) или имя пользователя (`str`) целевого чата.
    
- `**user_id**(int | str)` - Уникальный идентификатор (`int`) или имя пользователя (`str`) целевого пользователя. Что касается вас самих, вы можете просто использовать `me` или `self`.

Возвращает [`ChatMember`](https://docs.pyrogram.org/api/types/ChatMember#pyrogram.types.ChatMember)– В случае успеха возвращается участник чата.

```python
# 3. Получить информацию об участнике чата  
  
def main():  
    with app:                                      
        group_url = "parsinger_pyrogram"     # Указываем имя группы или канала  
        members = app.get_chat_member(            # Получаем информацию об участнике чата  
            chat_id=group_url,                    # ID чата или его имя  
            user_id='@HybridAppParser51'               # ID пользователя или его имя пользователя  
        )  
        print(members)                            # Выводим информацию об участнике чата  
  
main()
```

`app.**get_messages(chat_id**, **message_ids**, **reply_to_message_ids**, **replies****)**`: Используется для получения одного или нескольких сообщений из чата.

- `**chat_id**(int | str)` - Это номер или имя чата, из которого вы хотите получить сообщения. Если вы хотите получить сообщения из своих сохраненных сообщений, используйте слово "me" или "self". Если вы хотите получить сообщения от конкретного контакта, используйте его номер телефона.
    
- `**message_ids(**int | Iterable of int, необязательный**)**` - Это номер(а) конкретного сообщения или нескольких сообщений, которые вы хотите получить. Вы можете указать один номер или список номеров(_далее разберём подробно_).
    
- `**reply_to_message_ids(**int | Iterable of int, необязательный**)**` - Если вы ответили на сообщение и хотите получить исходное сообщение, на которое вы ответили, используйте этот параметр. Если вы уже использовали `message_ids`, то этот параметр не будет учитываться.
    
- `**replies**(int, необязательный)` - Это количество ответов на сообщение, которые вы хотите получить. Если вы не хотите получать ответы, укажите 0. Если вы хотите получить все ответы, укажите -1. Если вы ничего не укажете, по умолчанию будет получен только один ответ.

```python
# 4. Получить сообщения из чата  
def main():  
    with app:  
        messages = app.get_messages(chat_id="@python_parsing",    # Указываем ID чата для поиска сообщений  
                                    message_ids=[123, 456, 789],  # Список ID сообщений, которые мы хотим получить  
                                    reply_to_message_ids=[321],   # ID сообщения, на которое были ответы  
                                    replies=5)                    # Количество ответов, которые мы хотим получить  
        print(messages)                                           # Выводим полученные сообщения  
  
main()
```

`app.**search_messages(chat_id, query, offset, filter, limit, from_user)**`: Ищет сообщения в чате или группе по определенным критериям.

- `**chat_id**(int | str)` - Это номер или имя пользователя чата, в котором вы хотите искать сообщения. Если вы хотите искать в своих сохраненных сообщениях, используйте "me" или "self".,
    
- `**query**(str, необязательный)` - Это слово или фраза, которую вы хотите найти в сообщениях. Если вы ищете фотографии или видео, этот параметр поможет найти те, у которых есть подписи с этим текстом.
    
- `**offset**(int, необязательный)` - Это стартовая точка поиска. Если вы поставите 0, поиск начнется с самого первого сообщения. Если вы поставите 10, поиск начнется с 11-го сообщения.
    
- `**filter**(enums.MessagesFilter, необязательный)` - Это специальный фильтр, который позволяет вам искать определенные типы сообщений, например, только фотографии или только видео.
    
- `**limit**(int, необязательный)` - Это максимальное количество сообщений, которые вы хотите получить. Если вы не укажете этот параметр, поиск вернет все подходящие сообщения.
    
- `**from_user**(int | str, необязательный)` - Это номер или имя пользователя человека, чьи сообщения вы хотите найти. Если вы хотите найти сообщения, которые вы отправили, используйте `me` или `self`.

```python
#Псевдокод для демонстрации функции с параметрами

def search_messages_example():
    chat_id = "Parsinger_Telethon_Test"  # Используйте ID чата или его имя пользователя
    query = "hello"                      # Текст для поиска в сообщениях
    offset = 0                           # Начать с самого первого сообщения
    filter = enums.MessagesFilter.PHOTO  # Искать только сообщения с фотографиями
    limit = 100                          # Ограничить результаты поиском первых 100 сообщений
    from_user = "some_user"              # Искать сообщения только от определенного пользователя

  
    for message in app.search_messages(
        chat_id=chat_id,
        query=query,
        offset=offset,
        filter=filter,
        limit=limit,
        from_user=from_user
    ):
        print(message.text)               # Вывести текст каждого найденного сообщения
```

`app.**get_chat_history(chat_id, limit, offset, offset_id, offset_date)**`: Получает историю сообщений из чата или группы.

- `**chat_id**(int | str)` - Это номер или имя пользователя чата(диалога), из которого вы хотите получить сообщения. Если вы хотите получить сообщения из своего личного "облака" (Saved Messages), используйте `me` или `self`. 
    
- `**limit**(int, необязательный)` - Это число, которое говорит, сколько сообщений вы хотите получить. Если вы не укажете этот параметр, то по умолчанию будут возвращены все доступные сообщения.
    
- `**offset**(int, необязательный)` - Это число, которое определяет, с какого сообщения начать подсчет. Это может быть полезно, если вы хотите пропустить определенное количество сообщений в начале списка.
    
- `**offset_id**(int, необязательный)` - Это идентификатор сообщения, с которого вы хотите начать получение сообщений. Это полезно, если вы знаете конкретный ID сообщения, с которого хотите начать.
    
- `**offset_date**(datetime, необязательный)` - Это дата, и если вы укажете ее, то будут возвращены сообщения, которые были отправлены до этой даты. Это полезно, если вы хотите получить старые сообщения до определенного момента времени.

```python
#Псевдокод для демонстрации функции с параметрами
   
def get_history():
    with app:
        chat_id = "parsinger_pyrogram"  # Используйте ID или имя пользователя чата
        limit = 100                          # Количество сообщений для получения
        offset = 0                           # Смещение относительно первого сообщения в истории
        offset_id = 0                        # ID сообщения, с которого начнется получение истории
        offset_date = datetime(2021, 1, 1)   # Получить сообщения, отправленные до 1 января 2021 года

        # Получаем историю чата
        for message in app.get_chat_history(chat_id, limit=limit, offset=offset, offset_id=offset_id, offset_date=offset_date):
            print(message.text)


get_history()

```


`app.**get_chat_photos(chat_id, limit)**`: Получает фотографии профиля чата или группы.

- `**chat_id**` - Это номер или имя чата, из которого вы хотите получить фотографии. Если вы хотите свои фотографии, напишите `me` или `self`. Если хотите фотографии друга, напишите его номер телефона или имя пользователя.
- `**limit**` - Это количество фотографий, которое вы хотите получить. Если вы не скажете, сколько хотите, программа попытается дать вам все фотографии.

```python
#Псевдокод для демонстрации функции с параметрами

def main():
    with app:
        chat_id = "username"  # Замените на имя пользователя или ID чата
        chat_photos = app.get_chat_photos(chat_id)
        
        for photo in chat_photos:
            # Скачиваем каждую фотографию профиля
            app.download_media(photo.file_id, file_name=f"{photo.file_id}.jpg")


main()
```