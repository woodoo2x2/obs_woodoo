

Библиотека Requests предоставляет возможность отправлять запросы, скрывая свой реальный IP-адрес. Зачем скрывать его? Например, при высокочастотных запросах есть риск получить бан.

```python
# Импорт библиотеки для HTTP-запросов
import requests

# Функция для выполнения запроса с использованием прокси
def make_request(url, proxy):
    try:
        response = requests.get(url=url, proxies=proxy)
        print(response.json())
    except Exception as e:
        print(f"Ошибка: {e}")

# URL для тестирования прокси
url = 'http://httpbin.org/ip'

# Прокси для HTTP и HTTPS
proxy_http_https = {
    'http': 'http://103.177.45.3:80',
    'https': 'https://103.177.45.3:80',
}
make_request(url, proxy_http_https)

# Прокси для SOCKS4
proxy_socks4 = {
    'http': 'socks4://103.177.45.3:80',
    'https': 'socks4://103.177.45.3:80',
}
make_request(url, proxy_socks4)

# Прокси для SOCKS5
proxy_socks5 = {
    'http': 'socks5://103.177.45.3:80',
    'https': 'socks5://103.177.45.3:80',
}
make_request(url, proxy_socks5)

# Прокси с авторизацией
proxy_with_auth = {
    'http': 'socks5://login:password@103.177.45.3:80',
    'https': 'socks5://login:password@103.177.45.3:80',
}
make_request(url, proxy_with_auth)
```

При запросе через прокси важно учитывать схемы (`http` и `https`). Если сайт, на который вы отправляете запрос, использует схему `http`, то в словаре `proxy` необходимо указать именно её. Если схема `https`, указывайте её. Метод `.get()` способен самостоятельно определить и выбрать нужную схему, поэтому в словаре `proxy` лучше указать обе схемы сразу.  
  
 

### Зачем две схемы `'http':'http://103.177.45.3:80'`:

- **HTTP и HTTPS**: Прокси-сервер может поддерживать как HTTP, так и HTTPS трафик. Некоторые сайты работают только через HTTPS, и в этом случае вам потребуется указать прокси для HTTPS. Если прокси поддерживает оба протокола, удобно указать их оба в словаре для универсальности.  
     

### Почему 'https':'socks4' стоят рядом `'https':'socks5://103.177.45.3:80'`:

- **Протоколы SOCKS4 и SOCKS5**: Это протоколы, которые позволяют передавать любые типы данных через прокси-сервер. Они обеспечивают дополнительный уровень анонимности по сравнению с обычными HTTP прокси.
    
- **HTTP и HTTPS для SOCKS**: SOCKS прокси поддерживают как HTTP, так и HTTPS трафик. По этой причине, вы можете видеть оба типа схем (`http` и `https`) с протоколом SOCKS4 или SOCKS5.
    
- **Универсальность**: Это сделано для универсальности, чтобы не важно было, какой протокол (`http` или `https`) использует целевой сайт, вы могли бы использовать один и тот же прокси для обоих.
    

### **С точки зрения парсинга, протоколы HTTP и HTTPS имеют несколько ключевых различий:**

Шифрование:

- **HTTP (HyperText Transfer Protocol)**: Не шифрует передаваемые данные, что делает их уязвимыми для перехвата и модификации.
- **HTTPS (HTTP Secure)**: Использует SSL/TLS для шифрования данных, что повышает уровень безопасности.

Anti-Scraping и Captchas:

- Некоторые сайты могут использовать дополнительные меры безопасности на HTTPS, такие как более строгие правила по применению CAPTCHA или другие механизмы анти-скрапинга.

Заголовки и Cookies:

- Оба протокола передают заголовки и cookies, но HTTPS предоставляет дополнительную безопасность за счет шифрования.

Изменение Протокола:

- Некоторые сайты автоматически перенаправляют с HTTP на HTTPS. Это может потребовать дополнительной логики в вашем коде для корректной обработки.

Вы можете скачать бесплатные прокси вбив в google запрос "[**Бесплатные прокси**](https://www.google.com/search?q=%D0%91%D0%B5%D1%81%D0%BF%D0%BB%D0%B0%D1%82%D0%BD%D1%8B%D0%B5+%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8&oq=%D0%91%D0%B5%D1%81%D0%BF%D0%BB%D0%B0%D1%82%D0%BD%D1%8B%D0%B5+%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8&gs_lcrp=EgZjaHJvbWUyCQgAEEUYORiABDIHCAEQABiABDIHCAIQABiABDIHCAMQABiABDIHCAQQABiABDIGCAUQRRg9MgYIBhBFGD0yBggHEEUYPdIBBzQ2MmowajGoAgCwAgA&sourceid=chrome&ie=UTF-8)".

Если вы не хотите тратить своё время на поиск рабочих прокси среди большого количества нерабочих на бесплатных площадках, то рекомендую приобрести их на **[proxy6.net](https://proxy6.net/?r=408871). Купон на скидку: DbGrzrxnzT**

  
При покупке выбирайте любую страну и обязательно SOCKS 5 или 4.  
![](https://ucarecdn.com/32470c6a-4573-48fe-ba96-0f1d68e8ab0e/)

Скопируйте этот код и запустите его у себя в терминале, чтобы посмотреть, как он работает, не забудьте добавить прокси в ваш файл, они должны иметь вид.

```
141.101.123.224:80
141.101.123.221:80
172.67.3.63:80
```

```
from random import choice
import requests

# Указываем URL, к которому будем отправлять запрос для тестирования прокси
url = 'http://httpbin.org/ip'

# Открываем файл с прокси и читаем его
with open('proxy.txt') as file:

    # Считываем содержимое файла и разделяем его на строки
    proxy_file = file.read().split('\n')
    

    for _ in range(1000):
        try:
            # Выбираем случайный прокси из списка и удаляем лишние пробелы
            ip = choice(proxy_file).strip()

            # Формируем словарь с прокси для http и https
            proxy = {
                'http': f'http://{ip}',
                'https': f'https://{ip}'
            }
            # Выполняем GET-запрос с использованием выбранного прокси
            response = requests.get(url=url, proxies=proxy)

            # Выводим результат в случае успешного подключения
            print(response.json(), 'Success connection')
        except Exception as _ex:

            # В случае неудачи пропускаем текущую итерацию
            continue

>>> {'origin': 'httpbin.org, 47.74.152.29'} Success connection
...
```

Этот код отправляет запрос к [http://httpbin.org/ip](http://httpbin.org/ip) и в ответ получает IP-адрес, который использовался в запросе.

1. **Открываем файл с прокси, считываем его и сохраняем список в переменную `proxy_file`.**
    
    - **Для чего**: Чтобы загрузить список доступных прокси для последующего использования.
    - **Почему**: Это удобный способ хранения прокси в отдельном файле, что упрощает их управление.
    - **С какой целью**: Цель — получить набор прокси, чтобы потом можно было выбирать из них случайным образом для каждого запроса.
2. **Запускаем цикл с 1000 итерациями. На каждой итерации выбираем один прокси случайным образом с помощью функции `random.choice()`.**
    
    - **Для чего**: Для тестирования большого числа прокси.
    - **Почему**: Таким образом, можно быстро выявить рабочие прокси из списка.
    - **С какой целью**: Цель — автоматизировать процесс тестирования прокси на их работоспособность.
3. **В словаре `proxy` формируем прокси с соответствующей схемой. Прокси должен быть в формате `http://203.24.108.168:80`.**
    
    - **Для чего**: Чтобы правильно настроить прокси для выполнения HTTP-запросов.
    - **Почему**: Прокси нуждается в правильной схеме (`http` или `https`), чтобы запрос был корректным.
    - **С какой целью**: Цель — обеспечить корректную конфигурацию прокси для отправки запросов.
4. **Осуществляем запрос к сайту, указанному в переменной `url`, передавая в параметры словарь с прокси `proxies=proxy`. В этом словаре всегда два элемента, и на каждой итерации IP-адрес новый.**
    
    - **Для чего**: Для проверки работоспособности выбранного прокси.
    - **Почему**: Передача прокси в параметры запроса позволяет обойти ограничения по IP или скрыть реальный IP.
    - **С какой целью**: Цель — выявить, какие прокси из списка работают корректно.
5. **Выводим результат в формате `.json()`.**
    
    - **Для чего**: Чтобы увидеть результат выполнения запроса и проверить, с каким IP он был сделан.
    - **Почему**: Формат JSON удобен для чтения и последующего анализа.
    - **С какой целью**: Цель — предоставить четкую и структурированную информацию о результатах каждого запроса.
6. **Весь код обернут в блок `try/except`, чтобы избежать сбоев из-за тайм-аута.**
    
    - **Для чего**: Чтобы обработать исключения и ошибки, которые могут возникнуть при выполнении запросов.
    - **Почему**: Не все прокси могут быть рабочими, и некоторые из них могут вызвать тайм-ауты или другие ошибки.
    - **С какой целью**: Цель — сделать код устойчивым к ошибкам, чтобы он мог продолжить работу, даже если некоторые прокси не работают.