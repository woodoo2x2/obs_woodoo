

Нередко при извлечении данных возникает необходимость получить их в определенном упорядоченном виде. Например, во время работы с персональными данными людей может понадобиться расположить их в лексикографическом порядке имен или в порядке увеличения возраста. В SQL для подобных задач предназначен оператор `ORDER BY`.

Чтобы извлечь информацию из базы данных в отсортированном виде, достаточно дополнить запрос оператором `ORDER BY` и указать название поля, по которому необходимо осуществить сортировку.

Результатом приведенного ниже запроса:

```sql
SELECT artist, trackname, release_date
FROM Songs
ORDER BY release_date;
```

является:

```no-highlight
+------------+----------------------+--------------+
| artist     | trackname            | release_date |
+------------+----------------------+--------------+
| Kate Bush  | Running up That Hill | 1985-08-05   |
| The Sounds | My Lover             | 2009-05-31   |
| Heart      | Crazy On You         | 2009-12-19   |
| The Sounds | Thrill               | 2016-11-11   |
| Morrissey  | Spent the Day in Bed | 2017-10-17   |
+------------+----------------------+--------------+
```

В данном примере извлекаются данные о песнях, однако в результирующей таблице они располагаются не в произвольном порядке, а в порядке возрастания значения поля `release_date`. Обратите внимание, что по умолчанию оператор `ORDER BY` выполняет сортировку именно по возрастанию.

В запросе оператор `ORDER BY` должен следовать после операторов `SELECT` и `FROM`, в противном случае запрос завершится с ошибкой.

Поля, по которым выполняется сортировка, необязательно должны быть извлечены, то есть сортировка может выполняться и по тем полям, которые не попадают в результирующую таблицу.

Результатом приведенного ниже запроса:

```sql
SELECT artist, trackname
FROM Songs
ORDER BY release_date;
```

является:

```no-highlight
+------------+----------------------+
| artist     | trackname            |
+------------+----------------------+
| Kate Bush  | Running up That Hill |
| The Sounds | My Lover             |
| Heart      | Crazy On You         |
| The Sounds | Thrill               |
| Morrissey  | Spent the Day in Bed |
+------------+----------------------+
```

Здесь сортировка выполняется по полю `release_date`, однако извлечение этого поля не выполняется.

### Сортировка по нескольким полям

Часто сортировки лишь по одному полю бывает недостаточно, поскольку несколько записей могут содержать одно и то же значение в том поле, по которому выполняется сортировка. Чтобы выполнить сортировку по нескольким полям, нужно перечислить их через запятую.

Результатом приведенного ниже запроса:

```sql
SELECT artist, trackname, streams
FROM Songs
ORDER BY artist, streams;
```

является:

```no-highlight
+------------+----------------------+---------+
| artist     | trackname            | streams |
+------------+----------------------+---------+
| Heart      | Crazy On You         | 76338   |
| Kate Bush  | Running up That Hill | 121495  |
| Morrissey  | Spent the Day in Bed | 174994  |
| The Sounds | Thrill               | 49345   |
| The Sounds | My Lover             | 99488   |
+------------+----------------------+---------+
```

Запрос выше выполняет сортировку сначала по полю `artist`, затем по полю `streams`. Если какие-либо две записи имеют разные значения в поле `artist`, они сортируются согласно этим значениям. Если какие-либо две записи имеют одинаковые значения в поле `artist`, они сортируются согласно значениям в поле `streams`.

### Сортировка по положению поля

	Вместо имен полей оператор `ORDER BY` позволяет указывать порядковые номера полей, по которым необходимо выполнить сортировку. Однако сортировка таким методом возможна только по тем полям, которые присутствуют в результирующей таблице. Нумеруются поля с единицы: первое поле результирующей таблицы имеет порядковый номер `1`, второе — `2` и так далее.

Например, запрос:

```
SELECT artist, trackname, streams
FROM Songs
ORDER BY artist, streams;
```

можно переписать следующим образом:

```sql
SELECT artist, trackname, streams
FROM Songs
ORDER BY 1, 3;
```

и получить аналогичный результат:

```no-highlight
+------------+----------------------+---------+
| artist     | trackname            | streams |
+------------+----------------------+---------+
| Heart      | Crazy On You         | 76338   |
| Kate Bush  | Running up That Hill | 121495  |
| Morrissey  | Spent the Day in Bed | 174994  |
| The Sounds | Thrill               | 49345   |
| The Sounds | My Lover             | 99488   |
+------------+----------------------+---------+
```

Второй запрос отличается от первого лишь тем, что использует для сортировки порядковые номера полей, а не их имена. Он осуществляет сортировку по первому полю (`artist`), а в случае совпадения — по третьему полю (`streams`).

Операторы `ORDER BY` и `LIMIT` могут использоваться вместе для решения различных задач. Например, с их помощью можно определить две песни, которые вышли позже всех остальных. Для этого сперва необходимо отсортировать музыкальные композиции в порядке убывания даты их выхода, а затем ограничить полученный результат до двух значений.

Результатом приведенного ниже запроса:

```sql
SELECT artist, trackname, release_date
FROM Songs
ORDER BY release_date DESC
LIMIT 2;
```

является:

```no-highlight
+------------+----------------------+--------------+
| artist     | trackname            | release_date |
+------------+----------------------+--------------+
| Morrissey  | Spent the Day in Bed | 2017-10-17   |
| The Sounds | Thrill               | 2016-11-11   |
+------------+----------------------+--------------+
```

Стоит отметить, что подобные манипуляции с данными возможны благодаря порядку, в котором запрос выполняет свои операции: сначала запрос извлекает записи из таблицы, затем сортирует и только после этого ограничивает определенным количеством.

Сортировка является одной из завершающих операций и выполняется уже после формирования результирующей таблицы, поэтому в блоке оператора `ORDER BY` можно указывать как фактические имена полей таблицы, из которой извлекаются данные, так и их псевдонимы.

Результатом приведенного ниже запроса:

```sql
SELECT artist, trackname AS track, release_date
FROM Songs
ORDER BY track;
```

является:

```no-highlight
+------------+----------------------+--------------+
| artist     | track                | release_date |
+------------+----------------------+--------------+
| Heart      | Crazy On You         | 2009-12-19   |
| The Sounds | My Lover             | 2009-05-31   |
| Kate Bush  | Running up That Hill | 1985-08-05   |
| Morrissey  | Spent the Day in Bed | 2017-10-17   |
| The Sounds | Thrill               | 2016-11-11   |
+------------+----------------------+--------------+
```

Если псевдоним состоит из нескольких слов, то при сортировке данных по этому псевдониму необходимо заключать его в обратные апострофы (` `` `).

Результатом приведенного ниже запроса:

```sql
SELECT artist, trackname AS 'track name'
FROM Songs
ORDER BY `track name`;
```

является:

```no-highlight
+------------+----------------------+
| artist     | track name           |
+------------+----------------------+
| Heart      | Crazy On You         |
| The Sounds | My Lover             |
| Kate Bush  | Running up That Hill |
| Morrissey  | Spent the Day in Bed |
| The Sounds | Thrill               |
+------------+----------------------+
```