## Метод Монте-Карло

Метод Монте-Карло – группа численных методов, основанных на воспроизведении и статистическом анализе большого числа реализаций случайного процесса. Проводится математическое моделирование случайных процессов и параметры их реализации оцениваются статистически. Метод лежит в основе статистического моделирования.

  Метод Монте-Карло часто называют методом статистических испытаний.

|   |   |   |
|---|---|---|
Основоположники метода Монте-Карло
|![|100](https://ucarecdn.com/141fe25b-7579-410b-b9db-a36445d0e4f3/)Станислав Улам
|![|100](https://ucarecdn.com/ba3dad2d-65cf-4e70-895f-a3d9c90f8f7c/)Джон фон Нейман
![|100](https://ucarecdn.com/9cbf8a91-00e2-4c56-8159-8964101e4e76/)Николас Метрополис|

Статистическое моделирование широко применяется для решения задач из различных областей человеческого знания - биологии, химии, физики, экономики и других. Задачи, где широко используется этот подход:

- численное интегрирование;
- расчеты в системах массового обслуживания;
- расчеты качества и надежности изделий;
- расчеты прохождения нейтронов и других частиц через вещество;
- передача сообщений при наличии помех;
- задачи теории игр;
- задачи динамики разреженного газа;
- задачи дискретной оптимизации;
- задачи финансовой математики.

## Вычисление площадей

Применим метод Монте-Карло и к задаче вычисления площади геометрической фигуры на плоскости.

Поместим фигуру в прямоугольник и будем наугад бросать точки в этот прямоугольник. Будем исходить из того, что чем больше площадь фигуры, тем чаще в нее будут попадать точки. Таким образом, при большом числе nn точек, наугад выбранных внутри прямоугольника, доля точек, содержащихся в данной фигуре kk, приближенно равна отношению площади этой фигуры и площади прямоугольника.

Если площадь прямоугольника равна S0S0​ и в результате испытаний, из которых при kk исходах случайные точки оказались внутри фигуры, то площадь SS фигуры будет определяться выражением S=kn⋅S0.S=nk​⋅S0​. Рассмотрим алгоритм решения задачи на конкретных примерах.

**Пример 1.** Рассмотрим фигуру, множество точек которой определяется следующей системой неравенств:

0≤x≤10≤
y≤1y≤x2



Графическое изображение указанной фигуры в плоскости xOy имеет вид:

![](https://ucarecdn.com/9fe3fe1e-fd53-4241-a4aa-ac20f19ebe8d/)

Площадь такой фигуры S=13≈ 0.33333S=31​≈ 0.33333 (считается через интеграл).

**Алгоритм Монте-Карло:** площадь искомой фигуры составляет часть квадрата со сторонами 11. Площадь такого квадрата равна 11.

1. Генерируем случайные числа xx и yy равномерно распределенные на отрезке [0; 1][0;1]. Это будут координаты случайной точки в квадрате, в которую заключена фигура, площадь которой требуется найти. Полученная точка может как попасть в исследуемую фигуру, так и не попасть.
2. Проверяем принадлежность точки к исследуемой фигуре. Если попадания нет, т.е. не выполняется неравенство y≤x2y≤x2, то переходим к пункту 1 и генерируем координаты новой точки. Если попадание есть, то фиксируем это попадание, то есть увеличиваем на единицу значение счетчика числа попаданий и снова переходим к пункту 1.

![](https://ucarecdn.com/cfc26f84-fdc7-4432-843e-9c819acced83/)

**Примечание.** Заметим, что попадание случайной точки точно на границу фигуры можно отнести как к первому, так и ко второму исходу.

Пункты 11 и 22 следует повторить в цикле достаточно большое количество nn раз. От количества повторений напрямую зависит точность результата. После проведения nn повторов площадь фигуры найдем по формуле: S=kn⋅S0.S=nk​⋅S0​.

Пример программы на Python:

```python
import random

n = 1000
k = 0
s0 = 1
for _ in range(n):
    x = random.uniform(0, 1)     # случайное число с плавающей точкой от 0 до 1
    y = random.uniform(0, 1)     # случайное число с плавающей точкой от 0 до 1

    if y <= x**2:                # если попадает в нужную область
        k += 1

print((k/n)*s0)
```

Составим таблицу:

|   |   |
|---|---|
|n|S|
|10|0.6|
|100|0.37|
|1000|0.337|
|10000|0.3337|
|100000|0.33329|
|10000000.333571|
|10000000|0.3332828|
|100000000|0.33336707|

**Пример 2.** Рассмотрим фигуру, множество точек которой определяется следующей системой неравенств:

{−2≤x≤2−2≤y≤2y3−2x2≤−12y+x3≤3⎩

⎨

⎧​−2≤x≤2−2≤y≤2y3−2x2≤−12y+x3≤3​Графическое изображение указанной фигуры в плоскости xOyxOy имеет вид:

![](https://ucarecdn.com/5f0652cf-0098-4cdd-a47c-de194b3bc4e3/)

Площадь этой фигуры нам заранее известна и равна S=8.38404S=8.38404.

![](https://ucarecdn.com/dbebbc79-a578-4bfa-b5ef-5c3b8816ef67/)

**Алгоритм Монте-Карло:** площадь искомой фигуры составляет часть квадрата со сторонами 44. Площадь такого квадрата равна 1616.

1. Генерируем случайные числа xx и yy, равномерно распределенные на отрезках [−2; 2][−2;2]. Это будут координаты случайных точек в квадрате, в который заключена фигура искомой площади. Полученная точка может как попасть в исследуемую фигуру, так и не не попасть.
2. Проверяем принадлежность точки к исследуемой фигуре. Если попадания нет, не выполняется хотя бы одно из  неравенств y3−2x2≤−1y3−2x2≤−1 или 2y+x3≤32y+x3≤3, переходим к пункту 11 и генерируем координаты новой точки. Если попадание есть, фиксируем это попадание, то есть увеличиваем на единицу значение счетчика числа попаданий и снова переходим к пункту 11.

```python
import random

n = 1000
k = 0
s0 = 16
for _ in range(n):
    x = random.uniform(-2, 2)
    y = random.uniform(-2, 2)

    if y**3 - 2*x**2 <= -1 and 2*y + x**3 <= 3:
        k += 1

print((k/n)*s0)
```

Составим таблицу:

|   |   |
|---|---|
|nn|SS|
|1010|9.69.6|
|100100|8.968.96|
|10001000|8.2248.224|
|1000010000|8.38248.3824|
|100000100000|8.365288.36528|
|10000001000000|8.3833768.383376|
|1000000010000000|8.38415848.3841584|
|100000000100000000|8.384041348.38404134|

## Примечания

**Примечание 1.** Свое экзотическое название метод получил от города Монте-Карло в княжестве Монако, известного благодаря казино, поскольку именно рулетка является одним из самых широко известных генераторов случайных чисел. Станислав Улам пишет в своей автобиографии «Приключения математика», что название было предложено Николасом Метрополисом в честь его дяди, азартного игрока.

![](https://e.profkiosk.ru//service_tbn2/9b62c152-c8a4-47c5-ab45-a0a3ab3d7a04.gif)

**Примечание 2.** Активное применение метода началось с появлением ЭВМ, способных выполнять сотни операций для получения необходимых статистических данных. Развитие метода Монте-Карло пришлось на 1950-е годы, когда его использовали ученые из лаборатории ВВС США и исследовательской корпорации RAND, работающие над созданием водородной бомбы, в том числе и гениальный ученый Джон фон Нейман. Неймана считают одним из основателей метода, как, впрочем, и самих ЭВМ.

**Примечание 3.** Аналогичным образом можно вычислять объемы тел в пространстве.