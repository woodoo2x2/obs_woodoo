

Несмотря на то, что у процедуры отсутствует возвращаемое значение, получить результаты выполненных в ее теле операций или вычислений можно. Реализуется это с помощью выходных параметров. При вызове процедуры в качестве значения выходного параметра передается не конкретное значение, а пользовательская переменная, и если процедура в своем теле присвоит выходному параметру какое-либо значение, такое же значение примет и переменная, указанная при вызове процедуры.

В качестве примера использования выходных параметров создадим процедуру `MAX_GRADE()`, которая принимает в качестве аргумента пользовательскую переменную и присваивает ей в качестве значения максимальную оценку из таблицы `Math`.

Результатом приведенного ниже запроса:

```sql
DELIMITER //
CREATE PROCEDURE MAX_GRADE(OUT score INT)
BEGIN
    SET score := (SELECT MAX(grade)
                  FROM Math);
END //
DELIMITER ;

SET @max_grade = NULL;

CALL MAX_GRADE(@max_grade);

SELECT @max_grade;
```

является:

```no-highlight
+------------+
| @max_grade |
+------------+
| 5          |
+------------+
```

Итак, процедура `MAX_GRADE()` имеет один целочисленный параметр `score`, который является выходным. В теле процедуры этому параметру присваивается максимальное значение поля `grade` таблицы `Math`. Поскольку параметр `score` является выходным, присвоенное ему значение можно получить путем передачи пользовательской переменной при вызове процедуры. В данном примере присвоенное параметру `score` значение записывается в переменную `@max_grade`, поскольку именно она была указана при вызове процедуры `MAX_GRADE()`.

 Выходной параметр хранимой процедуры всегда имеет начальное значение, равное `NULL`.

Количество выходных параметров также не ограничивается одним параметром, их может быть и больше. В качестве следующего примера создадим процедуру `MIN_MAX_GRADES()`, которая принимает в качестве аргументов две пользовательские переменные и присваивает первой переменной в качестве значения минимальную оценку из таблицы `Math`, второй — максимальную.

Результатом приведенного ниже запроса:

```sql
DELIMITER //
CREATE PROCEDURE MIN_MAX_GRADES(OUT min_score INT, OUT max_score INT)
BEGIN
    SET min_score := (SELECT MIN(grade)
                      FROM Math),
        max_score := (SELECT MAX(grade)
                      FROM Math);
END //
DELIMITER ;

SET @min_grade := NULL,
    @max_grade := NULL;

CALL MIN_MAX_GRADES(@min_grade, @max_grade);

SELECT @min_grade, @max_grade;
```

является:

```no-highlight
+------------+------------+
| @min_grade | @max_grade |
+------------+------------+
| 1          | 5          |
+------------+------------+
```
Хранимые процедуры поддерживают дополнительный вид параметров, определяемый с помощью ключевого слова `INOUT`. Параметр, перед именем которого указано такое ключевое слово, ведет себя как **входной и выходной одновременно**.

Входной-выходной параметр по функционалу похож на выходной параметр, поскольку в качестве его аргумента также указывается пользовательская переменная. Однако если начальное значение выходного параметра всегда равно `NULL`, то начальное значение входного-выходного параметра определяется значением пользовательской переменной, которое передается ему в качестве аргумента.

Результатом приведенного ниже запроса:

```sql
DELIMITER //
CREATE PROCEDURE PROC(OUT parameter INT)
BEGIN
    SELECT parameter;
END //
DELIMITER ;

SET @variable := 1;

CALL PROC(@variable);
```

является:

```no-highlight
+-----------+
| parameter |
+-----------+
| NULL      |
+-----------+
```

В то время как результатом приведенного ниже запроса:

```sql
DELIMITER //
CREATE PROCEDURE PROC(INOUT parameter INT)
BEGIN
    SELECT parameter;
END //
DELIMITER ;

SET @variable := 1;

CALL PROC(@variable);
```

является:

```no-highlight
+-----------+
| parameter |
+-----------+
| 1         |
+-----------+
```

 [[Переменные SQL|Пользовательскую переменную]], которая будет передана в качестве аргумента выходному параметру, можно не создавать явно. В таком случае переменная будет создана автоматически.

Результатом приведенного ниже запроса:

```sql
DELIMITER //
CREATE PROCEDURE MAX_GRADE(OUT score INT)
BEGIN
    SELECT MAX(grade) INTO score
    FROM Math;
END //
DELIMITER ;

CALL MAX_GRADE(@max_grade);

SELECT @max_grade;
```

является:

```no-highlight
+------------+
| @max_grade |
+------------+
| 5          |
+------------+
```

 Параметры процедуры по умолчанию являются входными, поэтому ключевое слово `IN` указывать необязательно.

Результатом приведенного ниже запроса:

```sql
DELIMITER //
CREATE PROCEDURE STUDENTS_WITH_GRADE(score INT)
BEGIN
    SELECT id, name, surname
    FROM Math
    WHERE grade = score;
END //
DELIMITER ;

CALL STUDENTS_WITH_GRADE(4);
```

является:

```no-highlight
+----+--------+---------+
| id | name   | surname |
+----+--------+---------+
| 4  | Gwen   | Stacy   |
| 9  | Curtis | Connors |
+----+--------+---------+
```
#sql