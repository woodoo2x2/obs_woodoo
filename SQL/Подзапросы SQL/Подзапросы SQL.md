[[Подзапросы с одним полем и одной записью]]
Подзапросы с одним полем и несколькими записями:
[[Ключевое слово ALL]]
[[Ключевое слово ANY]]

[[Некоррелированные подзапросы]]
[[Коррелированные подзапросы]]
[[Подзапросы с несколькими полями]]
[[Подзапросы при работе с несколькими таблицами]]

До сих пор во всех наших запросах мы обращались к таблице и единожды извлекали из нее необходимые данные. Мы могли дополнительно фильтровать или сортировать их, но в любом случае извлечение записей из таблицы выполнялось лишь один раз. Однако в рамках одного запроса данные из таблицы могут извлекаться несколько раз, и для выполнения таких вспомогательных операций извлечения используются **подзапросы**.

Подзапрос — это запрос, вложенный в другой запрос. Подзапрос всегда заключен в круглые скобки и обычно выполняется перед основным запросом. Подзапросы являются обычными запросами, и для них не предусмотрен какой-либо отдельный синтаксис, поэтому для составления подзапросов достаточно уметь составлять обычные запросы.

Так как результатом подзапроса является таблица, она может быть указана после ключевого слова `FROM`. В таком случае основной запрос будет работать с той таблицей, которую вернул подзапрос.

Результатом приведенного ниже запроса:

```sql
SELECT *
FROM (SELECT title, author, price
      FROM Books) AS BooksCopy;
```

является:

```no-highlight
+------------------------------------------+---------------------+-------+
| title                                    | author              | price |
+------------------------------------------+---------------------+-------+
| The Shining                              | Stephen King        | 7.99  |
| Fight Club                               | Chuck Palahniuk     | 9.99  |
| The Catcher in the Rye                   | J.D. Salinger       | 3.49  |
| The Green Mile                           | Stephen King        | 15.99 |
| The Great Gatsby                         | F. Scott Fitzgerald | 7.99  |
| The Lord of the Rings                    | J.R.R. Tolkien      | 19.99 |
| It                                       | Stephen King        | 12.99 |
| The Silmarillion                         | J.R.R. Tolkien      | 11.99 |
| Haunted                                  | Chuck Palahniuk     | 13.99 |
| Harry Potter and the Prisoner of Azkaban | J.K. Rowling        | 9.99  |
+------------------------------------------+---------------------+-------+
```

Обратите внимание, что при использовании подзапроса совместно с ключевым словом `FROM` ему необходимо присвоить псевдоним, в противном случае при выполнении запроса произойдет ошибка. 

Результатом приведенного ниже запроса:

```sql
SELECT *
FROM (SELECT title, author, price
      FROM Books);
```

является ошибка:

```no-highlight
ERROR 1248: Every derived table must have its own alias
```

 Если результатом подзапроса является таблица с единственным значением, то это значение может быть извлечено с помощью оператора `SELECT`, например, как обычное число.

Результатом приведенного ниже запроса:

```
SELECT (SELECT SUM(price)
        FROM Books) AS total;
```

является:

```no-highlight
+--------------------+
| total              |
+--------------------+
| 114.39999794960022 |
+--------------------+
```

Если результатом подзапроса является пустая таблица, она приравнивается к значению `NULL`.

 Результатом приведенного ниже запроса:

```sql
SELECT (SELECT title
        FROM Books
        WHERE id = 121) AS title;
```

является:

```no-highlight
+-------+
| title |
+-------+
| NULL  |
+-------+
```

В данном случае подзапрос пытается вернуть запись из таблицы `Books`, значение поля `id` которой равняется `121`, однако в таблице нет такой записи, поэтому подзапрос возвращает пустую таблицу, которая основным запросом трактуется как значение `NULL`.