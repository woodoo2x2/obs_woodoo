Функция `LAST_VALUE()` используется для получения значения, которое содержится в определенном поле последней записи окна. В качестве примера ее использования напишем запрос, который зарплате каждого сотрудника ставит в соответствие зарплату самого последнего сотрудника (сотрудника с наибольшим идентификатором).

Результатом приведенного ниже запроса:

```sql
SELECT id, full_name, salary,
       LAST_VALUE(salary) OVER (ORDER BY id
                                ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_employee_salary
FROM Employees;
```

является:

```no-highlight
+----+-----------------+--------+----------------------+
| id | full_name       | salary | last_employee_salary |
+----+-----------------+--------+----------------------+
| 1  | Sergey Brin     | 10000  | 12000                |
| 2  | John Doerr      | 10000  | 12000                |
| 3  | Larry Page      | 7000   | 12000                |
| 4  | Eric Schmidt    | 8000   | 12000                |
| 5  | Sundar Pichai   | 11000  | 12000                |
| 6  | Marissa Mayer   | 9000   | 12000                |
| 7  | Susan Wojcicki  | 8000   | 12000                |
| 8  | John Smith      | 7000   | 12000                |
| 9  | Sheryl Sandberg | 9000   | 12000                |
| 10 | Alice Johnson   | 12000  | 12000                |
+----+-----------------+--------+----------------------+
```

Обратите внимание, что в данном примере дополнительно определяются границы окна: от самой первой записи до самой последней. Во время использования функции `LAST_VALUE()` этот шаг является очень важным, поскольку если границы будут определены по умолчанию, оконная функция может выполнять не то, что требуется.

Результатом приведенного ниже запроса:

```sql
SELECT id, full_name, salary,
       LAST_VALUE(salary) OVER (ORDER BY id) AS last_employee_salary
FROM Employees;
```

является:

```no-highlight
+----+-----------------+--------+----------------------+
| id | full_name       | salary | last_employee_salary |
+----+-----------------+--------+----------------------+
| 1  | Sergey Brin     | 10000  | 10000                |
| 2  | John Doerr      | 10000  | 10000                |
| 3  | Larry Page      | 7000   | 7000                 |
| 4  | Eric Schmidt    | 8000   | 8000                 |
| 5  | Sundar Pichai   | 11000  | 11000                |
| 6  | Marissa Mayer   | 9000   | 9000                 |
| 7  | Susan Wojcicki  | 8000   | 8000                 |
| 8  | John Smith      | 7000   | 7000                 |
| 9  | Sheryl Sandberg | 9000   | 9000                 |
| 10 | Alice Johnson   | 12000  | 12000                |
+----+-----------------+--------+----------------------+
```

В данном случае функция `LAST_VALUE()` применяется к окну, упорядоченному по полю `id`, границы которого определены по умолчанию: от самой первой записи до текущей. Таким образом, для каждой записи оконная функция возвращает значение поля `salary` самой же записи, поскольку в тех рамках окна, в которых выполняется функция, текущая запись является последней.